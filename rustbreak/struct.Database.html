<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `Database` struct in crate `rustbreak`.">
    <meta name="keywords" content="rust, rustlang, rust-lang, Database">

    <title>rustbreak::Database - Rust</title>

    <link rel="stylesheet" type="text/css" href="../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../main.css">
    

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        
        <p class='location'><a href='index.html'>rustbreak</a></p><script>window.sidebarCurrent = {name: 'Database', ty: 'struct', relpath: ''};</script><script defer src="sidebar-items.js"></script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content struct">
<h1 class='fqn'><span class='in-band'>Struct <a href='index.html'>rustbreak</a>::<wbr><a class='struct' href=''>Database</a></span><span class='out-of-band'><span id='render-detail'>
                   <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                       [<span class='inner'>&#x2212;</span>]
                   </a>
               </span><a id='src-108' class='srclink' href='../src/rustbreak/src/lib.rs.html#112-115' title='goto source code'>[src]</a></span></h1>
<pre class='rust struct'>pub struct Database&lt;T:&nbsp;<a class='trait' href='../serde/ser/trait.Serialize.html' title='serde::ser::Serialize'>Serialize</a> + <a class='trait' href='../serde/de/trait.Deserialize.html' title='serde::de::Deserialize'>Deserialize</a> + <a class='trait' href='https://doc.rust-lang.org/nightly/core/cmp/trait.Eq.html' title='core::cmp::Eq'>Eq</a> + <a class='trait' href='https://doc.rust-lang.org/nightly/core/hash/trait.Hash.html' title='core::hash::Hash'>Hash</a>&gt; {
    // some fields omitted
}</pre><div class='docblock'><p>The Database structure</p>

<h1 id='notes' class='section-header'><a href='#notes'>Notes</a></h1>
<p>One should need to create this once for each Database instance.
Subsequent tries to open the same file should fail or worse, could break the database.</p>

<h1 id='example' class='section-header'><a href='#example'>Example</a></h1>
<pre class='rust rust-example-rendered'>
<span class='kw'>use</span> <span class='ident'>rustbreak</span>::<span class='ident'>Database</span>;

<span class='kw'>let</span> <span class='ident'>db</span> <span class='op'>=</span> <span class='ident'>Database</span>::<span class='ident'>open</span>(<span class='string'>&quot;/tmp/artists&quot;</span>).<span class='ident'>unwrap</span>();

<span class='kw'>let</span> <span class='ident'>albums</span> <span class='op'>=</span> <span class='macro'>vec</span><span class='macro'>!</span>[
    (<span class='string'>&quot;What you do&quot;</span>, <span class='string'>&quot;The Queenstons&quot;</span>),
    (<span class='string'>&quot;Experience&quot;</span>, <span class='string'>&quot;The Prodigy&quot;</span>),
];

<span class='kw'>for</span> (<span class='ident'>album</span>, <span class='ident'>artist</span>) <span class='kw'>in</span> <span class='ident'>albums</span> {
    <span class='ident'>db</span>.<span class='ident'>insert</span>(<span class='kw-2'>&amp;</span><span class='macro'>format</span><span class='macro'>!</span>(<span class='string'>&quot;album_{}&quot;</span>,<span class='ident'>album</span>), <span class='ident'>artist</span>).<span class='ident'>unwrap</span>();
}
<span class='ident'>db</span>.<span class='ident'>flush</span>().<span class='ident'>unwrap</span>();</pre>
</div><h2 id='methods'>Methods</h2><h3 class='impl'><span class='in-band'><code>impl&lt;T:&nbsp;<a class='trait' href='../serde/ser/trait.Serialize.html' title='serde::ser::Serialize'>Serialize</a> + <a class='trait' href='../serde/de/trait.Deserialize.html' title='serde::de::Deserialize'>Deserialize</a> + <a class='trait' href='https://doc.rust-lang.org/nightly/core/cmp/trait.Eq.html' title='core::cmp::Eq'>Eq</a> + <a class='trait' href='https://doc.rust-lang.org/nightly/core/hash/trait.Hash.html' title='core::hash::Hash'>Hash</a>&gt; <a class='struct' href='../rustbreak/struct.Database.html' title='rustbreak::Database'>Database</a>&lt;T&gt;</code></span><span class='out-of-band'><div class='ghost'></div><a id='src-112' class='srclink' href='../src/rustbreak/src/lib.rs.html#117-273' title='goto source code'>[src]</a></span></h3>
<div class='impl-items'><h4 id='method.open' class='method'><code>fn <a href='#method.open' class='fnname'>open</a>&lt;P:&nbsp;<a class='trait' href='https://doc.rust-lang.org/nightly/core/convert/trait.AsRef.html' title='core::convert::AsRef'>AsRef</a>&lt;<a class='struct' href='https://doc.rust-lang.org/nightly/std/path/struct.Path.html' title='std::path::Path'>Path</a>&gt;&gt;(path: P) -&gt; <a class='type' href='../rustbreak/type.BreakResult.html' title='rustbreak::BreakResult'>BreakResult</a>&lt;<a class='struct' href='../rustbreak/struct.Database.html' title='rustbreak::Database'>Database</a>&lt;T&gt;&gt;</code></h4>
<div class='docblock'><p>Opens a new Database</p>

<p>This might fail if the file is non-empty and was not created by RustBreak, or if the file
is already being used by another RustBreak instance.</p>

<h1 id='example-1' class='section-header'><a href='#example-1'>Example</a></h1>
<pre class='rust rust-example-rendered'>
<span class='kw'>use</span> <span class='ident'>rustbreak</span>::<span class='ident'>Database</span>;

<span class='kw'>let</span> <span class='ident'>db</span> <span class='op'>=</span> <span class='ident'>Database</span>::<span class='ident'>open</span>(<span class='string'>&quot;/tmp/more_artists&quot;</span>).<span class='ident'>unwrap</span>();

<span class='kw'>let</span> <span class='ident'>albums</span> <span class='op'>=</span> <span class='macro'>vec</span><span class='macro'>!</span>[
    (<span class='string'>&quot;What you do&quot;</span>, <span class='string'>&quot;The Queenstons&quot;</span>),
    (<span class='string'>&quot;Experience&quot;</span>, <span class='string'>&quot;The Prodigy&quot;</span>),
];

<span class='kw'>for</span> (<span class='ident'>album</span>, <span class='ident'>artist</span>) <span class='kw'>in</span> <span class='ident'>albums</span> {
    <span class='ident'>db</span>.<span class='ident'>insert</span>(<span class='kw-2'>&amp;</span><span class='macro'>format</span><span class='macro'>!</span>(<span class='string'>&quot;album_{}&quot;</span>,<span class='ident'>album</span>), <span class='ident'>artist</span>).<span class='ident'>unwrap</span>();
}
<span class='ident'>db</span>.<span class='ident'>flush</span>().<span class='ident'>unwrap</span>();</pre>
</div><h4 id='method.insert' class='method'><code>fn <a href='#method.insert' class='fnname'>insert</a>&lt;S:&nbsp;<a class='trait' href='../serde/ser/trait.Serialize.html' title='serde::ser::Serialize'>Serialize</a> + 'static,&nbsp;K:&nbsp;?<a class='trait' href='https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html' title='core::marker::Sized'>Sized</a>&gt;(&amp;self, key: &amp;K, obj: S) -&gt; <a class='type' href='../rustbreak/type.BreakResult.html' title='rustbreak::BreakResult'>BreakResult</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>()</a>&gt; <span class='where'>where T: <a class='trait' href='https://doc.rust-lang.org/nightly/core/borrow/trait.Borrow.html' title='core::borrow::Borrow'>Borrow</a>&lt;K&gt;, K: <a class='trait' href='https://doc.rust-lang.org/nightly/core/hash/trait.Hash.html' title='core::hash::Hash'>Hash</a> + <a class='trait' href='https://doc.rust-lang.org/nightly/core/cmp/trait.PartialEq.html' title='core::cmp::PartialEq'>PartialEq</a> + <a class='trait' href='https://doc.rust-lang.org/nightly/collections/borrow/trait.ToOwned.html' title='collections::borrow::ToOwned'>ToOwned</a>&lt;Owned=T&gt;</span></code></h4>
<div class='docblock'><p>Insert a given Object into the Database at that key</p>

<p>This will overwrite any existing objects.</p>

<p>The Object has to be serializable. For best results do not
put in anything that is expensive to clone.</p>
</div><h4 id='method.retrieve' class='method'><code>fn <a href='#method.retrieve' class='fnname'>retrieve</a>&lt;S:&nbsp;<a class='trait' href='../serde/de/trait.Deserialize.html' title='serde::de::Deserialize'>Deserialize</a>,&nbsp;K:&nbsp;?<a class='trait' href='https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html' title='core::marker::Sized'>Sized</a>&gt;(&amp;self, key: &amp;K) -&gt; <a class='type' href='../rustbreak/type.BreakResult.html' title='rustbreak::BreakResult'>BreakResult</a>&lt;S&gt; <span class='where'>where T: <a class='trait' href='https://doc.rust-lang.org/nightly/core/borrow/trait.Borrow.html' title='core::borrow::Borrow'>Borrow</a>&lt;K&gt;, K: <a class='trait' href='https://doc.rust-lang.org/nightly/core/hash/trait.Hash.html' title='core::hash::Hash'>Hash</a> + <a class='trait' href='https://doc.rust-lang.org/nightly/core/cmp/trait.Eq.html' title='core::cmp::Eq'>Eq</a></span></code></h4>
<div class='docblock'><p>Retrieves an Object from the Database</p>

<h1 id='errors' class='section-header'><a href='#errors'>Errors</a></h1>
<p>This will return an <code>Err(BreakError::NotFound)</code> if there is no key behind the object.
If you tried to request something that it can&#39;t be serialized to then
<code>Err(BreakError::Deserialize)</code> will be returned.</p>

<h1 id='example-2' class='section-header'><a href='#example-2'>Example</a></h1>
<pre class='rust rust-example-rendered'>
<span class='kw'>use</span> <span class='ident'>rustbreak</span>::{<span class='ident'>Database</span>, <span class='ident'>BreakError</span>};

<span class='kw'>let</span> <span class='ident'>db</span> <span class='op'>=</span> <span class='ident'>Database</span>::<span class='ident'>open</span>(<span class='string'>&quot;/tmp/stuff&quot;</span>).<span class='ident'>unwrap</span>();

<span class='kw'>for</span> <span class='ident'>i</span> <span class='kw'>in</span> <span class='number'>0</span>..<span class='number'>5i64</span> {
    <span class='ident'>db</span>.<span class='ident'>insert</span>(<span class='kw-2'>&amp;</span><span class='macro'>format</span><span class='macro'>!</span>(<span class='string'>&quot;num_{}&quot;</span>, <span class='ident'>i</span>), <span class='ident'>i</span><span class='op'>*</span><span class='ident'>i</span><span class='op'>*</span><span class='ident'>i</span>).<span class='ident'>unwrap</span>();
}

<span class='kw'>let</span> <span class='ident'>num</span> : <span class='ident'>i64</span> <span class='op'>=</span> <span class='ident'>db</span>.<span class='ident'>retrieve</span>::<span class='op'>&lt;</span><span class='ident'>i64</span>, <span class='ident'>str</span><span class='op'>&gt;</span>(<span class='string'>&quot;num_0&quot;</span>).<span class='ident'>unwrap</span>();
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>num</span>, <span class='number'>0</span>);
<span class='kw'>match</span> <span class='ident'>db</span>.<span class='ident'>retrieve</span>::<span class='op'>&lt;</span><span class='ident'>usize</span>, <span class='ident'>str</span><span class='op'>&gt;</span>(<span class='string'>&quot;non-existent&quot;</span>) {
    <span class='prelude-val'>Err</span>(<span class='ident'>BreakError</span>::<span class='ident'>NotFound</span>) <span class='op'>=&gt;</span> {},
    _ <span class='op'>=&gt;</span> <span class='macro'>panic</span><span class='macro'>!</span>(<span class='string'>&quot;Was still found?&quot;</span>),
}

<span class='kw'>match</span> <span class='ident'>db</span>.<span class='ident'>retrieve</span>::<span class='op'>&lt;</span><span class='ident'>Vec</span><span class='op'>&lt;</span><span class='ident'>String</span><span class='op'>&gt;</span>, <span class='ident'>str</span><span class='op'>&gt;</span>(<span class='string'>&quot;num_1&quot;</span>) {
    <span class='prelude-val'>Err</span>(<span class='ident'>BreakError</span>::<span class='ident'>Deserialize</span>(..)) <span class='op'>=&gt;</span> {},
    _ <span class='op'>=&gt;</span> <span class='macro'>panic</span><span class='macro'>!</span>(<span class='string'>&quot;Was deserialized?&quot;</span>),
}</pre>
</div><h4 id='method.contains_key' class='method'><code>fn <a href='#method.contains_key' class='fnname'>contains_key</a>&lt;S:&nbsp;<a class='trait' href='../serde/de/trait.Deserialize.html' title='serde::de::Deserialize'>Deserialize</a>,&nbsp;K:&nbsp;?<a class='trait' href='https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html' title='core::marker::Sized'>Sized</a>&gt;(&amp;self, key: &amp;K) -&gt; <a class='type' href='../rustbreak/type.BreakResult.html' title='rustbreak::BreakResult'>BreakResult</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.bool.html'>bool</a>&gt; <span class='where'>where T: <a class='trait' href='https://doc.rust-lang.org/nightly/core/borrow/trait.Borrow.html' title='core::borrow::Borrow'>Borrow</a>&lt;K&gt;, K: <a class='trait' href='https://doc.rust-lang.org/nightly/core/hash/trait.Hash.html' title='core::hash::Hash'>Hash</a> + <a class='trait' href='https://doc.rust-lang.org/nightly/core/cmp/trait.Eq.html' title='core::cmp::Eq'>Eq</a></span></code></h4>
<div class='docblock'><p>Checks wether a given key exists in the Database</p>
</div><h4 id='method.flush' class='method'><code>fn <a href='#method.flush' class='fnname'>flush</a>(&amp;self) -&gt; <a class='type' href='../rustbreak/type.BreakResult.html' title='rustbreak::BreakResult'>BreakResult</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>()</a>&gt;</code></h4>
<div class='docblock'><p>Flushes the Database to disk</p>
</div><h4 id='method.transaction' class='method'><code>fn <a href='#method.transaction' class='fnname'>transaction</a>(&amp;self) -&gt; <a class='struct' href='../rustbreak/struct.Transaction.html' title='rustbreak::Transaction'>Transaction</a>&lt;T&gt;</code></h4>
<div class='docblock'><p>Starts a transaction</p>

<p>This borrows the Database mutably! Which means that during the Transaction you cannot write
to it. This keeps the Database consistent. Be sure to not do anything too costly while it
is borrowed.</p>
</div><h4 id='method.lock' class='method'><code>fn <a href='#method.lock' class='fnname'>lock</a>(&amp;self) -&gt; <a class='type' href='../rustbreak/type.BreakResult.html' title='rustbreak::BreakResult'>BreakResult</a>&lt;<a class='struct' href='../rustbreak/struct.Lock.html' title='rustbreak::Lock'>Lock</a>&lt;T&gt;&gt;</code></h4>
<div class='docblock'><p>Locks the Database, making sure only the caller can change it</p>

<p>This write locks the Database until the <code>Lock</code> has been dropped.</p>

<h1 id='panics' class='section-header'><a href='#panics'>Panics</a></h1>
<p>If you panic while holding the lock it will get poisoned and subsequent calls to it will
fail. You will have to re-open the Database to be able to continue accessing it.</p>
</div></div><h2 id='implementations'>Trait Implementations</h2><h3 class='impl'><span class='in-band'><code>impl&lt;T:&nbsp;<a class='trait' href='https://doc.rust-lang.org/nightly/core/fmt/trait.Debug.html' title='core::fmt::Debug'>Debug</a> + <a class='trait' href='../serde/ser/trait.Serialize.html' title='serde::ser::Serialize'>Serialize</a> + <a class='trait' href='../serde/de/trait.Deserialize.html' title='serde::de::Deserialize'>Deserialize</a> + <a class='trait' href='https://doc.rust-lang.org/nightly/core/cmp/trait.Eq.html' title='core::cmp::Eq'>Eq</a> + <a class='trait' href='https://doc.rust-lang.org/nightly/core/hash/trait.Hash.html' title='core::hash::Hash'>Hash</a>&gt; <a class='trait' href='https://doc.rust-lang.org/nightly/core/fmt/trait.Debug.html' title='core::fmt::Debug'>Debug</a> for <a class='struct' href='../rustbreak/struct.Database.html' title='rustbreak::Database'>Database</a>&lt;T&gt;</code></span><span class='out-of-band'><div class='ghost'></div><a id='src-100' class='srclink' href='../src/rustbreak/src/lib.rs.html#111' title='goto source code'>[src]</a></span></h3>
<div class='impl-items'><h4 id='method.fmt' class='method'><code>fn <a href='https://doc.rust-lang.org/nightly/core/fmt/trait.Debug.html#tymethod.fmt' class='fnname'>fmt</a>(&amp;self, __arg_0: &amp;mut <a class='struct' href='https://doc.rust-lang.org/nightly/core/fmt/struct.Formatter.html' title='core::fmt::Formatter'>Formatter</a>) -&gt; <a class='type' href='https://doc.rust-lang.org/nightly/core/fmt/type.Result.html' title='core::fmt::Result'>Result</a></code></h4>
<div class='docblock'><p>Formats the value using the given formatter.</p>
</div></div></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                    <dt>+</dt>
                    <dd>Collapse/expand all sections</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code> or <code>* -> vec</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../";
        window.currentCrate = "rustbreak";
        window.playgroundUrl = "";
    </script>
    <script src="../jquery.js"></script>
    <script src="../main.js"></script>
    
    <script defer src="../search-index.js"></script>
</body>
</html>